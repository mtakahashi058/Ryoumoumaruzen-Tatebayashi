//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "DMFrm.h"
#include <StrUtils.hpp>
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TDM *DM;
//---------------------------------------------------------------------------
__fastcall TDM::TDM(TComponent* Owner)
	: TDataModule(Owner), DBI(ADOConnection)
{
}
//---------------------------------------------------------------------------
void __fastcall TDM::ADOConnectionBeforeConnect(TObject *Sender)
{
	ini_.Load(ExtractFilePath(Application->ExeName) + "settings.ini");
	ADOConnection->ConnectionString = "FILE NAME=" + ToString(ini_["ADO::UDL"]);
}
//---------------------------------------------------------------------------
AnsiString __fastcall TDM::GetReportSQL(AnsiString target, AnsiString where)
{
	AnsiString sql =
		" DECLARE @DATE_FROM [DECIMAL]"
		" DECLARE @DATE_TO   [DECIMAL]"
		" SET @DATE_FROM = :DATE_FROM"
		" SET @DATE_TO   = :DATE_TO"
		" "
		" SELECT"
		" 	項目ID, MAX(項目コード) AS 項目コード, MAX(項目略称) AS 項目略称,"
		" 	SUM(件数01) AS 件数01,"
		" 	SUM(件数02) AS 件数02,"
		" 	SUM(件数03) AS 件数03,"
		" 	SUM(件数04) AS 件数04,"
		" 	SUM(件数05) AS 件数05,"
		" 	SUM(件数06) AS 件数06,"
		" 	SUM(件数07) AS 件数07,"
		" 	SUM(件数08) AS 件数08,"
		" 	SUM(件数09) AS 件数09,"
		" 	SUM(件数10) AS 件数10,"
		" 	SUM(件数11) AS 件数11,"
		" 	SUM(件数12) AS 件数12,"
		" 	SUM(件数13) AS 件数13,"
		" 	SUM(件数14) AS 件数14,"
		" 	SUM(件数15) AS 件数15,"
		" 	SUM(件数16) AS 件数16,"
		" 	SUM(件数17) AS 件数17,"
		" 	SUM(件数18) AS 件数18,"
		" 	SUM(件数19) AS 件数19,"
		" 	SUM(件数20) AS 件数20,"
		" 	SUM(件数21) AS 件数21,"
		" 	SUM(件数22) AS 件数22,"
		" 	SUM(件数23) AS 件数23,"
		" 	SUM(件数24) AS 件数24,"
		" 	SUM(件数25) AS 件数25,"
		" 	SUM(件数26) AS 件数26,"
		" 	SUM(件数27) AS 件数27,"
		" 	SUM(件数28) AS 件数28,"
		" 	SUM(件数29) AS 件数29,"
		" 	SUM(件数30) AS 件数30,"
		" 	SUM(件数31) AS 件数31,"
		" "
		" 	SUM(重量01) AS 重量01,"
		" 	SUM(重量02) AS 重量02,"
		" 	SUM(重量03) AS 重量03,"
		" 	SUM(重量04) AS 重量04,"
		" 	SUM(重量05) AS 重量05,"
		" 	SUM(重量06) AS 重量06,"
		" 	SUM(重量07) AS 重量07,"
		" 	SUM(重量08) AS 重量08,"
		" 	SUM(重量09) AS 重量09,"
		" 	SUM(重量10) AS 重量10,"
		" 	SUM(重量11) AS 重量11,"
		" 	SUM(重量12) AS 重量12,"
		" 	SUM(重量13) AS 重量13,"
		" 	SUM(重量14) AS 重量14,"
		" 	SUM(重量15) AS 重量15,"
		" 	SUM(重量16) AS 重量16,"
		" 	SUM(重量17) AS 重量17,"
		" 	SUM(重量18) AS 重量18,"
		" 	SUM(重量19) AS 重量19,"
		" 	SUM(重量20) AS 重量20,"
		" 	SUM(重量21) AS 重量21,"
		" 	SUM(重量22) AS 重量22,"
		" 	SUM(重量23) AS 重量23,"
		" 	SUM(重量24) AS 重量24,"
		" 	SUM(重量25) AS 重量25,"
		" 	SUM(重量26) AS 重量26,"
		" 	SUM(重量27) AS 重量27,"
		" 	SUM(重量28) AS 重量28,"
		" 	SUM(重量29) AS 重量29,"
		" 	SUM(重量30) AS 重量30,"
		" 	SUM(重量31) AS 重量31,"
		" "
		" 	SUM(金額01) AS 金額01,"
		" 	SUM(金額02) AS 金額02,"
		" 	SUM(金額03) AS 金額03,"
		" 	SUM(金額04) AS 金額04,"
		" 	SUM(金額05) AS 金額05,"
		" 	SUM(金額06) AS 金額06,"
		" 	SUM(金額07) AS 金額07,"
		" 	SUM(金額08) AS 金額08,"
		" 	SUM(金額09) AS 金額09,"
		" 	SUM(金額10) AS 金額10,"
		" 	SUM(金額11) AS 金額11,"
		" 	SUM(金額12) AS 金額12,"
		" 	SUM(金額13) AS 金額13,"
		" 	SUM(金額14) AS 金額14,"
		" 	SUM(金額15) AS 金額15,"
		" 	SUM(金額16) AS 金額16,"
		" 	SUM(金額17) AS 金額17,"
		" 	SUM(金額18) AS 金額18,"
		" 	SUM(金額19) AS 金額19,"
		" 	SUM(金額20) AS 金額20,"
		" 	SUM(金額21) AS 金額21,"
		" 	SUM(金額22) AS 金額22,"
		" 	SUM(金額23) AS 金額23,"
		" 	SUM(金額24) AS 金額24,"
		" 	SUM(金額25) AS 金額25,"
		" 	SUM(金額26) AS 金額26,"
		" 	SUM(金額27) AS 金額27,"
		" 	SUM(金額28) AS 金額28,"
		" 	SUM(金額29) AS 金額29,"
		" 	SUM(金額30) AS 金額30,"
		" 	SUM(金額31) AS 金額31"
		" FROM"
		" 	("
		" 	SELECT"
		" 		$TARGET$"
		" 	"
		" 		CASE WHEN 日 =  1 THEN 1 ELSE 0 END AS 件数01,"
		" 		CASE WHEN 日 =  2 THEN 1 ELSE 0 END AS 件数02,"
		" 		CASE WHEN 日 =  3 THEN 1 ELSE 0 END AS 件数03,"
		" 		CASE WHEN 日 =  4 THEN 1 ELSE 0 END AS 件数04,"
		" 		CASE WHEN 日 =  5 THEN 1 ELSE 0 END AS 件数05,"
		" 		CASE WHEN 日 =  6 THEN 1 ELSE 0 END AS 件数06,"
		" 		CASE WHEN 日 =  7 THEN 1 ELSE 0 END AS 件数07,"
		" 		CASE WHEN 日 =  8 THEN 1 ELSE 0 END AS 件数08,"
		" 		CASE WHEN 日 =  9 THEN 1 ELSE 0 END AS 件数09,"
		" 		CASE WHEN 日 = 10 THEN 1 ELSE 0 END AS 件数10,"
		" 		CASE WHEN 日 = 11 THEN 1 ELSE 0 END AS 件数11,"
		" 		CASE WHEN 日 = 12 THEN 1 ELSE 0 END AS 件数12,"
		" 		CASE WHEN 日 = 13 THEN 1 ELSE 0 END AS 件数13,"
		" 		CASE WHEN 日 = 14 THEN 1 ELSE 0 END AS 件数14,"
		" 		CASE WHEN 日 = 15 THEN 1 ELSE 0 END AS 件数15,"
		" 		CASE WHEN 日 = 16 THEN 1 ELSE 0 END AS 件数16,"
		" 		CASE WHEN 日 = 17 THEN 1 ELSE 0 END AS 件数17,"
		" 		CASE WHEN 日 = 18 THEN 1 ELSE 0 END AS 件数18,"
		" 		CASE WHEN 日 = 19 THEN 1 ELSE 0 END AS 件数19,"
		" 		CASE WHEN 日 = 20 THEN 1 ELSE 0 END AS 件数20,"
		" 		CASE WHEN 日 = 21 THEN 1 ELSE 0 END AS 件数21,"
		" 		CASE WHEN 日 = 22 THEN 1 ELSE 0 END AS 件数22,"
		" 		CASE WHEN 日 = 23 THEN 1 ELSE 0 END AS 件数23,"
		" 		CASE WHEN 日 = 24 THEN 1 ELSE 0 END AS 件数24,"
		" 		CASE WHEN 日 = 25 THEN 1 ELSE 0 END AS 件数25,"
		" 		CASE WHEN 日 = 26 THEN 1 ELSE 0 END AS 件数26,"
		" 		CASE WHEN 日 = 27 THEN 1 ELSE 0 END AS 件数27,"
		" 		CASE WHEN 日 = 28 THEN 1 ELSE 0 END AS 件数28,"
		" 		CASE WHEN 日 = 29 THEN 1 ELSE 0 END AS 件数29,"
		" 		CASE WHEN 日 = 30 THEN 1 ELSE 0 END AS 件数30,"
		" 		CASE WHEN 日 = 31 THEN 1 ELSE 0 END AS 件数31,"
		" 	"
		" 		CASE WHEN 日 =  1 THEN 正味重量 ELSE 0 END AS 重量01,"
		" 		CASE WHEN 日 =  2 THEN 正味重量 ELSE 0 END AS 重量02,"
		" 		CASE WHEN 日 =  3 THEN 正味重量 ELSE 0 END AS 重量03,"
		" 		CASE WHEN 日 =  4 THEN 正味重量 ELSE 0 END AS 重量04,"
		" 		CASE WHEN 日 =  5 THEN 正味重量 ELSE 0 END AS 重量05,"
		" 		CASE WHEN 日 =  6 THEN 正味重量 ELSE 0 END AS 重量06,"
		" 		CASE WHEN 日 =  7 THEN 正味重量 ELSE 0 END AS 重量07,"
		" 		CASE WHEN 日 =  8 THEN 正味重量 ELSE 0 END AS 重量08,"
		" 		CASE WHEN 日 =  9 THEN 正味重量 ELSE 0 END AS 重量09,"
		" 		CASE WHEN 日 = 10 THEN 正味重量 ELSE 0 END AS 重量10,"
		" 		CASE WHEN 日 = 11 THEN 正味重量 ELSE 0 END AS 重量11,"
		" 		CASE WHEN 日 = 12 THEN 正味重量 ELSE 0 END AS 重量12,"
		" 		CASE WHEN 日 = 13 THEN 正味重量 ELSE 0 END AS 重量13,"
		" 		CASE WHEN 日 = 14 THEN 正味重量 ELSE 0 END AS 重量14,"
		" 		CASE WHEN 日 = 15 THEN 正味重量 ELSE 0 END AS 重量15,"
		" 		CASE WHEN 日 = 16 THEN 正味重量 ELSE 0 END AS 重量16,"
		" 		CASE WHEN 日 = 17 THEN 正味重量 ELSE 0 END AS 重量17,"
		" 		CASE WHEN 日 = 18 THEN 正味重量 ELSE 0 END AS 重量18,"
		" 		CASE WHEN 日 = 19 THEN 正味重量 ELSE 0 END AS 重量19,"
		" 		CASE WHEN 日 = 20 THEN 正味重量 ELSE 0 END AS 重量20,"
		" 		CASE WHEN 日 = 21 THEN 正味重量 ELSE 0 END AS 重量21,"
		" 		CASE WHEN 日 = 22 THEN 正味重量 ELSE 0 END AS 重量22,"
		" 		CASE WHEN 日 = 23 THEN 正味重量 ELSE 0 END AS 重量23,"
		" 		CASE WHEN 日 = 24 THEN 正味重量 ELSE 0 END AS 重量24,"
		" 		CASE WHEN 日 = 25 THEN 正味重量 ELSE 0 END AS 重量25,"
		" 		CASE WHEN 日 = 26 THEN 正味重量 ELSE 0 END AS 重量26,"
		" 		CASE WHEN 日 = 27 THEN 正味重量 ELSE 0 END AS 重量27,"
		" 		CASE WHEN 日 = 28 THEN 正味重量 ELSE 0 END AS 重量28,"
		" 		CASE WHEN 日 = 29 THEN 正味重量 ELSE 0 END AS 重量29,"
		" 		CASE WHEN 日 = 30 THEN 正味重量 ELSE 0 END AS 重量30,"
		" 		CASE WHEN 日 = 31 THEN 正味重量 ELSE 0 END AS 重量31,"
		" 	"
		" 		CASE WHEN 日 =  1 THEN 金額 ELSE 0 END AS 金額01,"
		" 		CASE WHEN 日 =  2 THEN 金額 ELSE 0 END AS 金額02,"
		" 		CASE WHEN 日 =  3 THEN 金額 ELSE 0 END AS 金額03,"
		" 		CASE WHEN 日 =  4 THEN 金額 ELSE 0 END AS 金額04,"
		" 		CASE WHEN 日 =  5 THEN 金額 ELSE 0 END AS 金額05,"
		" 		CASE WHEN 日 =  6 THEN 金額 ELSE 0 END AS 金額06,"
		" 		CASE WHEN 日 =  7 THEN 金額 ELSE 0 END AS 金額07,"
		" 		CASE WHEN 日 =  8 THEN 金額 ELSE 0 END AS 金額08,"
		" 		CASE WHEN 日 =  9 THEN 金額 ELSE 0 END AS 金額09,"
		" 		CASE WHEN 日 = 10 THEN 金額 ELSE 0 END AS 金額10,"
		" 		CASE WHEN 日 = 11 THEN 金額 ELSE 0 END AS 金額11,"
		" 		CASE WHEN 日 = 12 THEN 金額 ELSE 0 END AS 金額12,"
		" 		CASE WHEN 日 = 13 THEN 金額 ELSE 0 END AS 金額13,"
		" 		CASE WHEN 日 = 14 THEN 金額 ELSE 0 END AS 金額14,"
		" 		CASE WHEN 日 = 15 THEN 金額 ELSE 0 END AS 金額15,"
		" 		CASE WHEN 日 = 16 THEN 金額 ELSE 0 END AS 金額16,"
		" 		CASE WHEN 日 = 17 THEN 金額 ELSE 0 END AS 金額17,"
		" 		CASE WHEN 日 = 18 THEN 金額 ELSE 0 END AS 金額18,"
		" 		CASE WHEN 日 = 19 THEN 金額 ELSE 0 END AS 金額19,"
		" 		CASE WHEN 日 = 20 THEN 金額 ELSE 0 END AS 金額20,"
		" 		CASE WHEN 日 = 21 THEN 金額 ELSE 0 END AS 金額21,"
		" 		CASE WHEN 日 = 22 THEN 金額 ELSE 0 END AS 金額22,"
		" 		CASE WHEN 日 = 23 THEN 金額 ELSE 0 END AS 金額23,"
		" 		CASE WHEN 日 = 24 THEN 金額 ELSE 0 END AS 金額24,"
		" 		CASE WHEN 日 = 25 THEN 金額 ELSE 0 END AS 金額25,"
		" 		CASE WHEN 日 = 26 THEN 金額 ELSE 0 END AS 金額26,"
		" 		CASE WHEN 日 = 27 THEN 金額 ELSE 0 END AS 金額27,"
		" 		CASE WHEN 日 = 28 THEN 金額 ELSE 0 END AS 金額28,"
		" 		CASE WHEN 日 = 29 THEN 金額 ELSE 0 END AS 金額29,"
		" 		CASE WHEN 日 = 30 THEN 金額 ELSE 0 END AS 金額30,"
		" 		CASE WHEN 日 = 31 THEN 金額 ELSE 0 END AS 金額31"
		" 	FROM"
		" 		V_計量"
		" 	WHERE"
		" 		計量日 BETWEEN @DATE_FROM AND @DATE_TO"
		" 	AND"
		" 		完了区分 = 1"
		" 	$WHERE$"
		" 	) AS D"
		" GROUP BY"
		" 	項目ID"
		" ORDER BY"
		" 	項目コード";

	sql = AnsiReplaceStr(sql, "$TARGET$", target);
	return AnsiReplaceStr(sql, "$WHERE$", where);
}
//---------------------------------------------------------------------------
AnsiString __fastcall TDM::GetTotalSQL(AnsiString where)
{
	AnsiString sql =
		" DECLARE @DATE_FROM [DECIMAL]"
		" DECLARE @DATE_TO   [DECIMAL]"
		" SET @DATE_FROM = :DATE_FROM"
		" SET @DATE_TO   = :DATE_TO"
		" "
		" SELECT"
		" 	SUM(件数01) AS 件数01,"
		" 	SUM(件数02) AS 件数02,"
		" 	SUM(件数03) AS 件数03,"
		" 	SUM(件数04) AS 件数04,"
		" 	SUM(件数05) AS 件数05,"
		" 	SUM(件数06) AS 件数06,"
		" 	SUM(件数07) AS 件数07,"
		" 	SUM(件数08) AS 件数08,"
		" 	SUM(件数09) AS 件数09,"
		" 	SUM(件数10) AS 件数10,"
		" 	SUM(件数11) AS 件数11,"
		" 	SUM(件数12) AS 件数12,"
		" 	SUM(件数13) AS 件数13,"
		" 	SUM(件数14) AS 件数14,"
		" 	SUM(件数15) AS 件数15,"
		" 	SUM(件数16) AS 件数16,"
		" 	SUM(件数17) AS 件数17,"
		" 	SUM(件数18) AS 件数18,"
		" 	SUM(件数19) AS 件数19,"
		" 	SUM(件数20) AS 件数20,"
		" 	SUM(件数21) AS 件数21,"
		" 	SUM(件数22) AS 件数22,"
		" 	SUM(件数23) AS 件数23,"
		" 	SUM(件数24) AS 件数24,"
		" 	SUM(件数25) AS 件数25,"
		" 	SUM(件数26) AS 件数26,"
		" 	SUM(件数27) AS 件数27,"
		" 	SUM(件数28) AS 件数28,"
		" 	SUM(件数29) AS 件数29,"
		" 	SUM(件数30) AS 件数30,"
		" 	SUM(件数31) AS 件数31,"
		" "
		" 	SUM(重量01) AS 重量01,"
		" 	SUM(重量02) AS 重量02,"
		" 	SUM(重量03) AS 重量03,"
		" 	SUM(重量04) AS 重量04,"
		" 	SUM(重量05) AS 重量05,"
		" 	SUM(重量06) AS 重量06,"
		" 	SUM(重量07) AS 重量07,"
		" 	SUM(重量08) AS 重量08,"
		" 	SUM(重量09) AS 重量09,"
		" 	SUM(重量10) AS 重量10,"
		" 	SUM(重量11) AS 重量11,"
		" 	SUM(重量12) AS 重量12,"
		" 	SUM(重量13) AS 重量13,"
		" 	SUM(重量14) AS 重量14,"
		" 	SUM(重量15) AS 重量15,"
		" 	SUM(重量16) AS 重量16,"
		" 	SUM(重量17) AS 重量17,"
		" 	SUM(重量18) AS 重量18,"
		" 	SUM(重量19) AS 重量19,"
		" 	SUM(重量20) AS 重量20,"
		" 	SUM(重量21) AS 重量21,"
		" 	SUM(重量22) AS 重量22,"
		" 	SUM(重量23) AS 重量23,"
		" 	SUM(重量24) AS 重量24,"
		" 	SUM(重量25) AS 重量25,"
		" 	SUM(重量26) AS 重量26,"
		" 	SUM(重量27) AS 重量27,"
		" 	SUM(重量28) AS 重量28,"
		" 	SUM(重量29) AS 重量29,"
		" 	SUM(重量30) AS 重量30,"
		" 	SUM(重量31) AS 重量31,"
		" "
		" 	SUM(金額01) AS 金額01,"
		" 	SUM(金額02) AS 金額02,"
		" 	SUM(金額03) AS 金額03,"
		" 	SUM(金額04) AS 金額04,"
		" 	SUM(金額05) AS 金額05,"
		" 	SUM(金額06) AS 金額06,"
		" 	SUM(金額07) AS 金額07,"
		" 	SUM(金額08) AS 金額08,"
		" 	SUM(金額09) AS 金額09,"
		" 	SUM(金額10) AS 金額10,"
		" 	SUM(金額11) AS 金額11,"
		" 	SUM(金額12) AS 金額12,"
		" 	SUM(金額13) AS 金額13,"
		" 	SUM(金額14) AS 金額14,"
		" 	SUM(金額15) AS 金額15,"
		" 	SUM(金額16) AS 金額16,"
		" 	SUM(金額17) AS 金額17,"
		" 	SUM(金額18) AS 金額18,"
		" 	SUM(金額19) AS 金額19,"
		" 	SUM(金額20) AS 金額20,"
		" 	SUM(金額21) AS 金額21,"
		" 	SUM(金額22) AS 金額22,"
		" 	SUM(金額23) AS 金額23,"
		" 	SUM(金額24) AS 金額24,"
		" 	SUM(金額25) AS 金額25,"
		" 	SUM(金額26) AS 金額26,"
		" 	SUM(金額27) AS 金額27,"
		" 	SUM(金額28) AS 金額28,"
		" 	SUM(金額29) AS 金額29,"
		" 	SUM(金額30) AS 金額30,"
		" 	SUM(金額31) AS 金額31"
		" FROM"
		" 	("
		" 	SELECT"
		" 		CASE WHEN 日 =  1 THEN 1 ELSE 0 END AS 件数01,"
		" 		CASE WHEN 日 =  2 THEN 1 ELSE 0 END AS 件数02,"
		" 		CASE WHEN 日 =  3 THEN 1 ELSE 0 END AS 件数03,"
		" 		CASE WHEN 日 =  4 THEN 1 ELSE 0 END AS 件数04,"
		" 		CASE WHEN 日 =  5 THEN 1 ELSE 0 END AS 件数05,"
		" 		CASE WHEN 日 =  6 THEN 1 ELSE 0 END AS 件数06,"
		" 		CASE WHEN 日 =  7 THEN 1 ELSE 0 END AS 件数07,"
		" 		CASE WHEN 日 =  8 THEN 1 ELSE 0 END AS 件数08,"
		" 		CASE WHEN 日 =  9 THEN 1 ELSE 0 END AS 件数09,"
		" 		CASE WHEN 日 = 10 THEN 1 ELSE 0 END AS 件数10,"
		" 		CASE WHEN 日 = 11 THEN 1 ELSE 0 END AS 件数11,"
		" 		CASE WHEN 日 = 12 THEN 1 ELSE 0 END AS 件数12,"
		" 		CASE WHEN 日 = 13 THEN 1 ELSE 0 END AS 件数13,"
		" 		CASE WHEN 日 = 14 THEN 1 ELSE 0 END AS 件数14,"
		" 		CASE WHEN 日 = 15 THEN 1 ELSE 0 END AS 件数15,"
		" 		CASE WHEN 日 = 16 THEN 1 ELSE 0 END AS 件数16,"
		" 		CASE WHEN 日 = 17 THEN 1 ELSE 0 END AS 件数17,"
		" 		CASE WHEN 日 = 18 THEN 1 ELSE 0 END AS 件数18,"
		" 		CASE WHEN 日 = 19 THEN 1 ELSE 0 END AS 件数19,"
		" 		CASE WHEN 日 = 20 THEN 1 ELSE 0 END AS 件数20,"
		" 		CASE WHEN 日 = 21 THEN 1 ELSE 0 END AS 件数21,"
		" 		CASE WHEN 日 = 22 THEN 1 ELSE 0 END AS 件数22,"
		" 		CASE WHEN 日 = 23 THEN 1 ELSE 0 END AS 件数23,"
		" 		CASE WHEN 日 = 24 THEN 1 ELSE 0 END AS 件数24,"
		" 		CASE WHEN 日 = 25 THEN 1 ELSE 0 END AS 件数25,"
		" 		CASE WHEN 日 = 26 THEN 1 ELSE 0 END AS 件数26,"
		" 		CASE WHEN 日 = 27 THEN 1 ELSE 0 END AS 件数27,"
		" 		CASE WHEN 日 = 28 THEN 1 ELSE 0 END AS 件数28,"
		" 		CASE WHEN 日 = 29 THEN 1 ELSE 0 END AS 件数29,"
		" 		CASE WHEN 日 = 30 THEN 1 ELSE 0 END AS 件数30,"
		" 		CASE WHEN 日 = 31 THEN 1 ELSE 0 END AS 件数31,"
		" 	"
		" 		CASE WHEN 日 =  1 THEN 正味重量 ELSE 0 END AS 重量01,"
		" 		CASE WHEN 日 =  2 THEN 正味重量 ELSE 0 END AS 重量02,"
		" 		CASE WHEN 日 =  3 THEN 正味重量 ELSE 0 END AS 重量03,"
		" 		CASE WHEN 日 =  4 THEN 正味重量 ELSE 0 END AS 重量04,"
		" 		CASE WHEN 日 =  5 THEN 正味重量 ELSE 0 END AS 重量05,"
		" 		CASE WHEN 日 =  6 THEN 正味重量 ELSE 0 END AS 重量06,"
		" 		CASE WHEN 日 =  7 THEN 正味重量 ELSE 0 END AS 重量07,"
		" 		CASE WHEN 日 =  8 THEN 正味重量 ELSE 0 END AS 重量08,"
		" 		CASE WHEN 日 =  9 THEN 正味重量 ELSE 0 END AS 重量09,"
		" 		CASE WHEN 日 = 10 THEN 正味重量 ELSE 0 END AS 重量10,"
		" 		CASE WHEN 日 = 11 THEN 正味重量 ELSE 0 END AS 重量11,"
		" 		CASE WHEN 日 = 12 THEN 正味重量 ELSE 0 END AS 重量12,"
		" 		CASE WHEN 日 = 13 THEN 正味重量 ELSE 0 END AS 重量13,"
		" 		CASE WHEN 日 = 14 THEN 正味重量 ELSE 0 END AS 重量14,"
		" 		CASE WHEN 日 = 15 THEN 正味重量 ELSE 0 END AS 重量15,"
		" 		CASE WHEN 日 = 16 THEN 正味重量 ELSE 0 END AS 重量16,"
		" 		CASE WHEN 日 = 17 THEN 正味重量 ELSE 0 END AS 重量17,"
		" 		CASE WHEN 日 = 18 THEN 正味重量 ELSE 0 END AS 重量18,"
		" 		CASE WHEN 日 = 19 THEN 正味重量 ELSE 0 END AS 重量19,"
		" 		CASE WHEN 日 = 20 THEN 正味重量 ELSE 0 END AS 重量20,"
		" 		CASE WHEN 日 = 21 THEN 正味重量 ELSE 0 END AS 重量21,"
		" 		CASE WHEN 日 = 22 THEN 正味重量 ELSE 0 END AS 重量22,"
		" 		CASE WHEN 日 = 23 THEN 正味重量 ELSE 0 END AS 重量23,"
		" 		CASE WHEN 日 = 24 THEN 正味重量 ELSE 0 END AS 重量24,"
		" 		CASE WHEN 日 = 25 THEN 正味重量 ELSE 0 END AS 重量25,"
		" 		CASE WHEN 日 = 26 THEN 正味重量 ELSE 0 END AS 重量26,"
		" 		CASE WHEN 日 = 27 THEN 正味重量 ELSE 0 END AS 重量27,"
		" 		CASE WHEN 日 = 28 THEN 正味重量 ELSE 0 END AS 重量28,"
		" 		CASE WHEN 日 = 29 THEN 正味重量 ELSE 0 END AS 重量29,"
		" 		CASE WHEN 日 = 30 THEN 正味重量 ELSE 0 END AS 重量30,"
		" 		CASE WHEN 日 = 31 THEN 正味重量 ELSE 0 END AS 重量31,"
		" 	"
		" 		CASE WHEN 日 =  1 THEN 金額 ELSE 0 END AS 金額01,"
		" 		CASE WHEN 日 =  2 THEN 金額 ELSE 0 END AS 金額02,"
		" 		CASE WHEN 日 =  3 THEN 金額 ELSE 0 END AS 金額03,"
		" 		CASE WHEN 日 =  4 THEN 金額 ELSE 0 END AS 金額04,"
		" 		CASE WHEN 日 =  5 THEN 金額 ELSE 0 END AS 金額05,"
		" 		CASE WHEN 日 =  6 THEN 金額 ELSE 0 END AS 金額06,"
		" 		CASE WHEN 日 =  7 THEN 金額 ELSE 0 END AS 金額07,"
		" 		CASE WHEN 日 =  8 THEN 金額 ELSE 0 END AS 金額08,"
		" 		CASE WHEN 日 =  9 THEN 金額 ELSE 0 END AS 金額09,"
		" 		CASE WHEN 日 = 10 THEN 金額 ELSE 0 END AS 金額10,"
		" 		CASE WHEN 日 = 11 THEN 金額 ELSE 0 END AS 金額11,"
		" 		CASE WHEN 日 = 12 THEN 金額 ELSE 0 END AS 金額12,"
		" 		CASE WHEN 日 = 13 THEN 金額 ELSE 0 END AS 金額13,"
		" 		CASE WHEN 日 = 14 THEN 金額 ELSE 0 END AS 金額14,"
		" 		CASE WHEN 日 = 15 THEN 金額 ELSE 0 END AS 金額15,"
		" 		CASE WHEN 日 = 16 THEN 金額 ELSE 0 END AS 金額16,"
		" 		CASE WHEN 日 = 17 THEN 金額 ELSE 0 END AS 金額17,"
		" 		CASE WHEN 日 = 18 THEN 金額 ELSE 0 END AS 金額18,"
		" 		CASE WHEN 日 = 19 THEN 金額 ELSE 0 END AS 金額19,"
		" 		CASE WHEN 日 = 20 THEN 金額 ELSE 0 END AS 金額20,"
		" 		CASE WHEN 日 = 21 THEN 金額 ELSE 0 END AS 金額21,"
		" 		CASE WHEN 日 = 22 THEN 金額 ELSE 0 END AS 金額22,"
		" 		CASE WHEN 日 = 23 THEN 金額 ELSE 0 END AS 金額23,"
		" 		CASE WHEN 日 = 24 THEN 金額 ELSE 0 END AS 金額24,"
		" 		CASE WHEN 日 = 25 THEN 金額 ELSE 0 END AS 金額25,"
		" 		CASE WHEN 日 = 26 THEN 金額 ELSE 0 END AS 金額26,"
		" 		CASE WHEN 日 = 27 THEN 金額 ELSE 0 END AS 金額27,"
		" 		CASE WHEN 日 = 28 THEN 金額 ELSE 0 END AS 金額28,"
		" 		CASE WHEN 日 = 29 THEN 金額 ELSE 0 END AS 金額29,"
		" 		CASE WHEN 日 = 30 THEN 金額 ELSE 0 END AS 金額30,"
		" 		CASE WHEN 日 = 31 THEN 金額 ELSE 0 END AS 金額31"
		" 	FROM"
		" 		V_計量"
		" 	WHERE"
		" 		計量日 BETWEEN @DATE_FROM AND @DATE_TO"
		" 	AND"
		" 		完了区分 = 1"
		" 	$WHERE$"
		" 	) AS D";

	return AnsiReplaceStr(sql, "$WHERE$", where);
}
//---------------------------------------------------------------------------

